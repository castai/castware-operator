image:
  repository: us-docker.pkg.dev/castai-hub/library/castware-operator
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: ""

leaderElection:
  enabled: true
  # Leader election resource lock type
  resourceLock: "leases"
  # Leader election resource name
  resourceName: "castware-operator-leader-election"

replicaCount: 1

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

namespace: "castai-agent"

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations: {}

securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL

podSecurityContext:
  runAsNonRoot: true
  fsGroup: 1005
  runAsGroup: 1005
  runAsUser: 1005
  seccompProfile:
    type: RuntimeDefault


livenessProbe:
  httpGet:
    path: /healthz
    port: 8081
  initialDelaySeconds: 15
  periodSeconds: 20

readinessProbe:
  httpGet:
    path: /readyz
    port: 8081
  initialDelaySeconds: 5
  periodSeconds: 10

service:
  type: ClusterIP
  port: 80

resources: {}

# CRD installation
installCRDs: true

# CRD upgrade configuration
# This enables automatic CRD upgrade during helm upgrade operations
crdUpgrade:
  enabled: true
  image:
    repository: lachlanevenson/k8s-kubectl
    tag: "v1.25.4"
    pullPolicy: IfNotPresent

preflightCheck:
  enabled: true

# Webhook configuration
webhook:
  enabled: true
  port: 9443
  timeoutSeconds: 10

metrics:
  enabled: true

apiKeySecret:
  # Whether to create the API key secret
  create: true
  # Name of the secret (defaults to "castware-api-key")
  name: "castware-api-key"
  # The actual API key value (should be set via --set apiKeySecret.apiKey=YOUR_API_KEY)
  apiKey: ""

# Node affinity configuration
affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
        - matchExpressions:
            - key: kubernetes.io/os
              operator: NotIn
              values:
                - windows

# Whether to create the extended permissions for the operator, needed for phase2 components
extendedPermissions: false

# Default cluster configuration
defaultCluster:
  terraform: true
  enabled: true
  # This will create a default Cluster CR if enabled
  name: "castai"
  api:
    apiUrl: "https://api.dev-master.cast.ai"  # "https://api.cast.ai"
  # If not specified, will use apiKeySecret.name from above
  apiKeySecret: ""
  provider: ""
  helmRepoURL: "https://castai.github.io/helm-charts"

# Default components configuration
defaultComponents:
  enabled: true
  # List of default components to create
  # Each component will be created with the specified configuration
  components:
    castai-agent:
      component: "castai-agent"
      cluster: "castai"
      enabled: true
    # spot-handler:
    #   component: "spot-handler"
    #   cluster: "castai"
    #   enabled: true
